{"remainingRequest":"/Users/alexey/work/vue3-minin-practice/node_modules/babel-loader/lib/index.js!/Users/alexey/work/vue3-minin-practice/src/store/modules/auth.module.js","dependencies":[{"path":"/Users/alexey/work/vue3-minin-practice/src/store/modules/auth.module.js","mtime":1648574457192},{"path":"/Users/alexey/work/vue3-minin-practice/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/alexey/work/vue3-minin-practice/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL2FsZXhleS93b3JrL3Z1ZTMtbWluaW4tcHJhY3RpY2Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICIvVXNlcnMvYWxleGV5L3dvcmsvdnVlMy1taW5pbi1wcmFjdGljZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCB7IGVycm9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3InOwp2YXIgVE9LRU5fS0VZID0gJ2p3dC10b2tlbic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lc3BhY2VkOiB0cnVlLAogIHN0YXRlOiBmdW5jdGlvbiBzdGF0ZSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRva2VuOiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9LRVkpCiAgICB9OwogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBzZXRUb2tlbjogZnVuY3Rpb24gc2V0VG9rZW4oc3RhdGUsIHRva2VuKSB7CiAgICAgIHN0YXRlLnRva2VuID0gdG9rZW47CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRPS0VOX0tFWSwgdG9rZW4pOwogICAgfSwKICAgIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KHN0YXRlKSB7CiAgICAgIHN0YXRlLnRva2VuID0gbnVsbDsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oVE9LRU5fS0VZKTsKICAgIH0KICB9LAogIGFjdGlvbnM6IHsKICAgIGxvZ2luOiBmdW5jdGlvbiBsb2dpbihfcmVmLCBwYXlsb2FkKSB7CiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGNvbW1pdCwgZGlzcGF0Y2gsIHVybCwgX3lpZWxkJGF4aW9zJHBvc3QsIGRhdGE7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYuY29tbWl0LCBkaXNwYXRjaCA9IF9yZWYuZGlzcGF0Y2g7CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTsKICAgICAgICAgICAgICAgIHVybCA9ICJodHRwczovL2lkZW50aXR5dG9vbGtpdC5nb29nbGVhcGlzLmNvbS92MS9hY2NvdW50czpzaWduSW5XaXRoUGFzc3dvcmQ/a2V5PSIuY29uY2F0KHByb2Nlc3MuZW52LlZVRV9BUFBfRkJfS0VZKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgcmV0dXJuIGF4aW9zLnBvc3QodXJsLCBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHBheWxvYWQpLCB7fSwgewogICAgICAgICAgICAgICAgICByZXR1cm5TZWN1cmVUb2tlbjogdHJ1ZQogICAgICAgICAgICAgICAgfSkpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfeWllbGQkYXhpb3MkcG9zdCA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgICBkYXRhID0gX3lpZWxkJGF4aW9zJHBvc3QuZGF0YTsKICAgICAgICAgICAgICAgIGNvbW1pdCgnc2V0VG9rZW4nLCBkYXRhLmlkVG9rZW4pOwogICAgICAgICAgICAgICAgY29tbWl0KCdjbGVhck1lc3NhZ2UnLCBudWxsLCB7CiAgICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDEpOwogICAgICAgICAgICAgICAgZGlzcGF0Y2goJ3NldE1lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgICAgIHZhbHVlOiBlcnJvcihfY29udGV4dC50MC5yZXNwb25zZS5kYXRhLmVycm9yLm1lc3NhZ2UpLAogICAgICAgICAgICAgICAgICB0eXBlOiAnZGFuZ2VyJwogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxLCAxMV1dKTsKICAgICAgfSkpKCk7CiAgICB9CiAgfSwKICBnZXR0ZXJzOiB7CiAgICB0b2tlbjogZnVuY3Rpb24gdG9rZW4oc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnRva2VuOwogICAgfSwKICAgIGlzQXV0aGVudGljYXRlZDogZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKF8sIGdldHRlcnMpIHsKICAgICAgcmV0dXJuICEhZ2V0dGVycy50b2tlbjsKICAgIH0KICB9Cn07"},{"version":3,"sources":["/Users/alexey/work/vue3-minin-practice/src/store/modules/auth.module.js"],"names":["axios","error","TOKEN_KEY","namespaced","state","token","localStorage","getItem","mutations","setToken","setItem","logout","removeItem","actions","login","payload","commit","dispatch","url","process","env","VUE_APP_FB_KEY","post","returnSecureToken","data","idToken","root","value","response","message","type","Error","getters","isAuthenticated","_"],"mappings":";;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,KAAR,QAAoB,mBAApB;AACA,IAAMC,SAAS,GAAG,WAAlB;AAEA,eAAe;AACbC,EAAAA,UAAU,EAAE,IADC;AAEbC,EAAAA,KAFa,mBAEL;AACN,WAAO;AACLC,MAAAA,KAAK,EAAEC,YAAY,CAACC,OAAb,CAAqBL,SAArB;AADF,KAAP;AAGD,GANY;AAObM,EAAAA,SAAS,EAAE;AACTC,IAAAA,QADS,oBACAL,KADA,EACOC,KADP,EACc;AACrBD,MAAAA,KAAK,CAACC,KAAN,GAAcA,KAAd;AACAC,MAAAA,YAAY,CAACI,OAAb,CAAqBR,SAArB,EAAgCG,KAAhC;AACD,KAJQ;AAKTM,IAAAA,MALS,kBAKFP,KALE,EAKK;AACZA,MAAAA,KAAK,CAACC,KAAN,GAAc,IAAd;AACAC,MAAAA,YAAY,CAACM,UAAb,CAAwBV,SAAxB;AACD;AARQ,GAPE;AAiBbW,EAAAA,OAAO,EAAE;AACDC,IAAAA,KADC,uBACyBC,OADzB,EACkC;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAA5BC,gBAAAA,MAA4B,QAA5BA,MAA4B,EAApBC,QAAoB,QAApBA,QAAoB;AAAA;AAE/BC,gBAAAA,GAF+B,uFAEoDC,OAAO,CAACC,GAAR,CAAYC,cAFhE;AAAA;AAAA,uBAGhBrB,KAAK,CAACsB,IAAN,CAAWJ,GAAX,kCAChBH,OADgB;AAEnBQ,kBAAAA,iBAAiB,EAAE;AAFA,mBAHgB;;AAAA;AAAA;AAG9BC,gBAAAA,IAH8B,qBAG9BA,IAH8B;AAOrCR,gBAAAA,MAAM,CAAC,UAAD,EAAaQ,IAAI,CAACC,OAAlB,CAAN;AACAT,gBAAAA,MAAM,CAAC,cAAD,EAAiB,IAAjB,EAAuB;AAACU,kBAAAA,IAAI,EAAE;AAAP,iBAAvB,CAAN;AARqC;AAAA;;AAAA;AAAA;AAAA;AAUrCT,gBAAAA,QAAQ,CACN,YADM,EAEN;AACEU,kBAAAA,KAAK,EAAE1B,KAAK,CAAC,YAAE2B,QAAF,CAAWJ,IAAX,CAAgBvB,KAAhB,CAAsB4B,OAAvB,CADd;AAEEC,kBAAAA,IAAI,EAAE;AAFR,iBAFM,EAMN;AAACJ,kBAAAA,IAAI,EAAE;AAAP,iBANM,CAAR;AAVqC,sBAkB/B,IAAIK,KAAJ,EAlB+B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBxC;AArBM,GAjBI;AAwCbC,EAAAA,OAAO,EAAE;AACP3B,IAAAA,KADO,iBACDD,KADC,EACM;AACX,aAAOA,KAAK,CAACC,KAAb;AACD,KAHM;AAIP4B,IAAAA,eAJO,2BAISC,CAJT,EAIYF,OAJZ,EAIqB;AAC1B,aAAO,CAAC,CAACA,OAAO,CAAC3B,KAAjB;AACD;AANM;AAxCI,CAAf","sourcesContent":["import axios from 'axios'\nimport {error} from '../../utils/error'\nconst TOKEN_KEY = 'jwt-token'\n\nexport default {\n  namespaced: true,\n  state() {\n    return {\n      token: localStorage.getItem(TOKEN_KEY)\n    }\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token\n      localStorage.setItem(TOKEN_KEY, token)\n    },\n    logout(state) {\n      state.token = null\n      localStorage.removeItem(TOKEN_KEY)\n    }\n  },\n  actions: {\n    async login({commit, dispatch}, payload) {\n      try {\n        const url = `https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=${process.env.VUE_APP_FB_KEY}`\n        const {data} = await axios.post(url, {\n          ...payload,\n          returnSecureToken: true\n        })\n        commit('setToken', data.idToken)\n        commit('clearMessage', null, {root: true})\n      } catch (e) {\n        dispatch(\n          'setMessage',\n          {\n            value: error(e.response.data.error.message),\n            type: 'danger'\n          },\n          {root: true}\n        )\n        throw new Error()\n      }\n    }\n  },\n  getters: {\n    token(state) {\n      return state.token\n    },\n    isAuthenticated(_, getters) {\n      return !!getters.token\n    }\n  }\n}\n"]}]}