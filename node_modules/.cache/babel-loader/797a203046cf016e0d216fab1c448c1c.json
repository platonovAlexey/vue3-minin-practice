{"remainingRequest":"/Users/alexey/work/vue3-minin-practice/node_modules/babel-loader/lib/index.js!/Users/alexey/work/vue3-minin-practice/src/use/login-form.js","dependencies":[{"path":"/Users/alexey/work/vue3-minin-practice/src/use/login-form.js","mtime":1648568271307},{"path":"/Users/alexey/work/vue3-minin-practice/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/alexey/work/vue3-minin-practice/node_modules/babel-loader/lib/index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudGltZXJzLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL2FsZXhleS93b3JrL3Z1ZTMtbWluaW4tcHJhY3RpY2Uvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgeyBjb21wdXRlZCwgd2F0Y2ggfSBmcm9tICd2dWUnOwppbXBvcnQgKiBhcyB5dXAgZnJvbSAneXVwJzsKaW1wb3J0IHsgdXNlRmllbGQsIHVzZUZvcm0gfSBmcm9tICd2ZWUtdmFsaWRhdGUnOwppbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICd2dWUtcm91dGVyJzsKZXhwb3J0IGZ1bmN0aW9uIHVzZUxvZ2luRm9ybSgpIHsKICB2YXIgc3RvcmUgPSB1c2VTdG9yZSgpOwogIHZhciByb3V0ZXIgPSB1c2VSb3V0ZXIoKTsKCiAgdmFyIF91c2VGb3JtID0gdXNlRm9ybSgpLAogICAgICBoYW5kbGVTdWJtaXQgPSBfdXNlRm9ybS5oYW5kbGVTdWJtaXQsCiAgICAgIGlzU3VibWl0dGluZyA9IF91c2VGb3JtLmlzU3VibWl0dGluZywKICAgICAgc3VibWl0Q291bnQgPSBfdXNlRm9ybS5zdWJtaXRDb3VudDsKCiAgdmFyIF91c2VGaWVsZCA9IHVzZUZpZWxkKCdlbWFpbCcsIHl1cC5zdHJpbmcoKS50cmltKCkucmVxdWlyZWQoJ9CS0LLQtdC00LjRgtC1IGVtYWlsJykuZW1haWwoJ9CS0LLQtdC00LjRgtC1INC60L7RgNGA0LXQutGC0L3Ri9C5IGVtYWlsJykpLAogICAgICBlbWFpbCA9IF91c2VGaWVsZC52YWx1ZSwKICAgICAgZUVycm9yID0gX3VzZUZpZWxkLmVycm9yTWVzc2FnZSwKICAgICAgZUJsdXIgPSBfdXNlRmllbGQuaGFuZGxlQmx1cjsKCiAgdmFyIG1pbkxlbmd0aFBhc3N3b3JkID0gNjsKCiAgdmFyIF91c2VGaWVsZDIgPSB1c2VGaWVsZCgncGFzc3dvcmQnLCB5dXAuc3RyaW5nKCkudHJpbSgpLnJlcXVpcmVkKCfQktCy0LXQtNC40YLQtSDQv9Cw0YDQvtC70YwnKS5taW4obWluTGVuZ3RoUGFzc3dvcmQsICJcdTA0MUZcdTA0MzBcdTA0NDBcdTA0M0VcdTA0M0JcdTA0NEMgXHUwNDNEXHUwNDM1IFx1MDQzQ1x1MDQzRVx1MDQzNlx1MDQzNVx1MDQ0MiBcdTA0MzFcdTA0NEJcdTA0NDJcdTA0NEMgXHUwNDNDXHUwNDM1XHUwNDNEXHUwNDM1XHUwNDM1ICIuY29uY2F0KG1pbkxlbmd0aFBhc3N3b3JkLCAiIFx1MDQ0MVx1MDQzOFx1MDQzQ1x1MDQzMlx1MDQzRVx1MDQzQlx1MDQzRVx1MDQzMiIpKSksCiAgICAgIHBhc3N3b3JkID0gX3VzZUZpZWxkMi52YWx1ZSwKICAgICAgcEVycm9yID0gX3VzZUZpZWxkMi5lcnJvck1lc3NhZ2UsCiAgICAgIHBCbHVyID0gX3VzZUZpZWxkMi5oYW5kbGVCbHVyOwoKICB2YXIgb25TdWJtaXQgPSBoYW5kbGVTdWJtaXQoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh2YWx1ZXMpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGb3JtOiAnLCB2YWx1ZXMpOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgnYXV0aC9sb2dpbicsIHZhbHVlcyk7CgogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgcm91dGVyLnB1c2goJy8nKTsKCiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSk7CgogICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKICB9KCkpOwogIHZhciBpc1Rvb01hbnlBdHRlbXB0cyA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBzdWJtaXRDb3VudC52YWx1ZSA+PSAzOwogIH0pOwogIHdhdGNoKGlzVG9vTWFueUF0dGVtcHRzLCBmdW5jdGlvbiAodmFsKSB7CiAgICBpZiAodmFsKSB7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHN1Ym1pdENvdW50LnZhbHVlID0gMDsKICAgICAgfSwgMTUwMCk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIHsKICAgIGVtYWlsOiBlbWFpbCwKICAgIHBhc3N3b3JkOiBwYXNzd29yZCwKICAgIGVFcnJvcjogZUVycm9yLAogICAgcEVycm9yOiBwRXJyb3IsCiAgICBlQmx1cjogZUJsdXIsCiAgICBwQmx1cjogcEJsdXIsCiAgICBvblN1Ym1pdDogb25TdWJtaXQsCiAgICBpc1N1Ym1pdHRpbmc6IGlzU3VibWl0dGluZywKICAgIGlzVG9vTWFueUF0dGVtcHRzOiBpc1Rvb01hbnlBdHRlbXB0cwogIH07Cn0="},{"version":3,"sources":["/Users/alexey/work/vue3-minin-practice/src/use/login-form.js"],"names":["computed","watch","yup","useField","useForm","useStore","useRouter","useLoginForm","store","router","handleSubmit","isSubmitting","submitCount","string","trim","required","email","value","eError","errorMessage","eBlur","handleBlur","minLengthPassword","min","password","pError","pBlur","onSubmit","values","console","log","dispatch","push","isTooManyAttempts","val","setTimeout"],"mappings":";;;;AAAA,SAASA,QAAT,EAAmBC,KAAnB,QAAgC,KAAhC;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,SAASC,QAAT,EAAmBC,OAAnB,QAAkC,cAAlC;AACA,SAASC,QAAT,QAAyB,MAAzB;AACA,SAASC,SAAT,QAA0B,YAA1B;AAEA,OAAO,SAASC,YAAT,GAAwB;AAC7B,MAAMC,KAAK,GAAGH,QAAQ,EAAtB;AACA,MAAMI,MAAM,GAAGH,SAAS,EAAxB;;AAF6B,iBAGuBF,OAAO,EAH9B;AAAA,MAGrBM,YAHqB,YAGrBA,YAHqB;AAAA,MAGPC,YAHO,YAGPA,YAHO;AAAA,MAGOC,WAHP,YAGOA,WAHP;;AAAA,kBAIqCT,QAAQ,CACxE,OADwE,EAExED,GAAG,CACAW,MADH,GAEGC,IAFH,GAGGC,QAHH,CAGY,eAHZ,EAIGC,KAJH,CAIS,0BAJT,CAFwE,CAJ7C;AAAA,MAIdA,KAJc,aAIrBC,KAJqB;AAAA,MAIOC,MAJP,aAIPC,YAJO;AAAA,MAI2BC,KAJ3B,aAIeC,UAJf;;AAY7B,MAAMC,iBAAiB,GAAG,CAA1B;;AAZ6B,mBAawCnB,QAAQ,CAC3E,UAD2E,EAE3ED,GAAG,CACAW,MADH,GAEGC,IAFH,GAGGC,QAHH,CAGY,gBAHZ,EAIGQ,GAJH,CAKID,iBALJ,qJAMkCA,iBANlC,uDAF2E,CAbhD;AAAA,MAadE,QAbc,cAarBP,KAbqB;AAAA,MAaUQ,MAbV,cAaJN,YAbI;AAAA,MAa8BO,KAb9B,cAakBL,UAblB;;AAyB7B,MAAMM,QAAQ,GAAGjB,YAAY;AAAA,uEAAC,iBAAOkB,MAAP;AAAA;AAAA;AAAA;AAAA;AAC5BC,cAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBF,MAAtB;AAD4B;AAAA,qBAEtBpB,KAAK,CAACuB,QAAN,CAAe,YAAf,EAA6BH,MAA7B,CAFsB;;AAAA;AAG5BnB,cAAAA,MAAM,CAACuB,IAAP,CAAY,GAAZ;;AAH4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;;AAAA;AAAA;AAAA;AAAA,MAA7B;AAMA,MAAMC,iBAAiB,GAAGjC,QAAQ,CAAC;AAAA,WAAMY,WAAW,CAACK,KAAZ,IAAqB,CAA3B;AAAA,GAAD,CAAlC;AAEAhB,EAAAA,KAAK,CAACgC,iBAAD,EAAoB,UAACC,GAAD,EAAS;AAChC,QAAIA,GAAJ,EAAS;AACPC,MAAAA,UAAU,CAAC,YAAM;AACfvB,QAAAA,WAAW,CAACK,KAAZ,GAAoB,CAApB;AACD,OAFS,EAEP,IAFO,CAAV;AAGD;AACF,GANI,CAAL;AAQA,SAAO;AACLD,IAAAA,KAAK,EAALA,KADK;AAELQ,IAAAA,QAAQ,EAARA,QAFK;AAGLN,IAAAA,MAAM,EAANA,MAHK;AAILO,IAAAA,MAAM,EAANA,MAJK;AAKLL,IAAAA,KAAK,EAALA,KALK;AAMLM,IAAAA,KAAK,EAALA,KANK;AAOLC,IAAAA,QAAQ,EAARA,QAPK;AAQLhB,IAAAA,YAAY,EAAZA,YARK;AASLsB,IAAAA,iBAAiB,EAAjBA;AATK,GAAP;AAWD","sourcesContent":["import { computed, watch } from 'vue';\nimport * as yup from 'yup';\nimport { useField, useForm } from 'vee-validate';\nimport { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\n\nexport function useLoginForm() {\n  const store = useStore();\n  const router = useRouter();\n  const { handleSubmit, isSubmitting, submitCount } = useForm();\n  const { value: email, errorMessage: eError, handleBlur: eBlur } = useField(\n    'email',\n    yup\n      .string()\n      .trim()\n      .required('Введите email')\n      .email('Введите корректный email')\n  );\n  const minLengthPassword = 6;\n  const { value: password, errorMessage: pError, handleBlur: pBlur } = useField(\n    'password',\n    yup\n      .string()\n      .trim()\n      .required('Введите пароль')\n      .min(\n        minLengthPassword,\n        `Пароль не может быть менее ${minLengthPassword} символов`\n      )\n  );\n\n  const onSubmit = handleSubmit(async (values) => {\n    console.log('Form: ', values);\n    await store.dispatch('auth/login', values);\n    router.push('/');\n  });\n\n  const isTooManyAttempts = computed(() => submitCount.value >= 3);\n\n  watch(isTooManyAttempts, (val) => {\n    if (val) {\n      setTimeout(() => {\n        submitCount.value = 0;\n      }, 1500);\n    }\n  });\n\n  return {\n    email,\n    password,\n    eError,\n    pError,\n    eBlur,\n    pBlur,\n    onSubmit,\n    isSubmitting,\n    isTooManyAttempts,\n  };\n}\n"]}]}